(type (List a)
  Nil
  (List a (List a)))

(type (Maybe a)
  None
  (Some a))

(define (main _)
  (let [[xs (List 42 (List 69 Nil))]]
    (match (bindMaybe head (tail xs))
      [(Some n) (printInt n)]
      [None     (printInt 666)])))

(define: (head xs)
    (forall [a] (Fun (List a) (Maybe a)))
  (match xs
    [Nil None]
    [(List x _) (Some x)]))

(define: tail
    (forall [a] (Fun (List a) (Maybe (List a))))
  (fun (ys)
    (match ys
      [Nil None]
      [(List _ xs) (Some xs)])))

(define: (bindMaybe f)
    (forall [a b] (Fun (Fun a (Maybe b))
                       (Maybe a)
                       (Maybe b)))
  (fun-match
    [(Some a) (f a)]
    [None None]))
